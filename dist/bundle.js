/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./scripts/index.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./scripts sync recursive":
/*!**********************!*\
  !*** ./scripts sync ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = \"./scripts sync recursive\";\n\n//# sourceURL=webpack:///./scripts_sync?");

/***/ }),

/***/ "./scripts/UI.js":
/*!***********************!*\
  !*** ./scripts/UI.js ***!
  \***********************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\nfunction UI ({\r\n  loadingScreen,\r\n  startScreen,\r\n  endScreen,\r\n  gameoverScreen\r\n}) {\r\n  this.loadingScreen = loadingScreen\r\n  this.startScreen = startScreen\r\n  this.endScreen = endScreen\r\n  this.gameoverScreen = gameoverScreen\r\n}\r\n\r\nUI.prototype = {\r\n  constructor: UI,\r\n  showScreen (screen, msg) {\r\n    \r\n  },\r\n  hideScreen () {\r\n    \r\n  }\r\n}\r\n\r\nlet startScreen = {\r\n\r\n}\r\n\r\nlet endScreen = {\r\n\r\n}\r\n\r\nlet gameoverScreen = {\r\n\r\n}\r\n\r\nlet loadingScreen = {\r\n\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (new UI({\r\n  loadingScreen,\r\n  startScreen,\r\n  endScreen,\r\n  gameoverScreen\r\n}));\n\n//# sourceURL=webpack:///./scripts/UI.js?");

/***/ }),

/***/ "./scripts/boxData.js":
/*!****************************!*\
  !*** ./scripts/boxData.js ***!
  \****************************/
/*! exports provided: resolvedBoxData */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"resolvedBoxData\", function() { return resolvedBoxData; });\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ \"./scripts/utils.js\");\n/**\r\n * 在每一种状态下的每一帧，角色精灵图可能有整体 whole、身体 body（即可被攻击）和攻击 attack 三种区域，\r\n * 这些区域统称为盒子，用于判断角色是否与地图碰撞（重叠）、攻击命中敌人、被攻击命中并改变状态，\r\n * 考虑到随时可能修改盒子，所以保留空白的状态对象\r\n **/\r\n\r\nlet boxData = {\r\n  'King Human': {\r\n    Attack: {\r\n      whole: [\r\n        {x: 19, y: 0, w: 59, h: 58},\r\n        {x: 22, y: 4, w: 48, h: 40},\r\n        {x: 9, y: 16, w: 37, h: 28}\r\n      ],\r\n      body: [\r\n        {x: 23, y: 16, w: 17, h: 24},\r\n        {x: 23, y: 15, w: 17, h: 25},\r\n        {x: 23, y: 16, w: 17, h: 26}\r\n      ],\r\n      attack: [\r\n        [{x: 51, y: 6, w: 27, h: 52}, {x: 19, y: 45, w: 32, h: 13}],\r\n        {x: 45, y: 4, w: 26, h: 40}\r\n      ]\r\n    },\r\n    Dead: {\r\n      whole: [\r\n        {x: 6, y: 18, w: 37, h: 26},\r\n        {x: 2, y: 25, w: 38, h: 24},\r\n        {x: 1, y: 26, w: 38, h: 21},\r\n        {x: 0, y: 27, w: 38, h: 22}\r\n      ]\r\n    },\r\n    'Door In': { /* blank */ },\r\n    'Door Out': { /* blank */ },\r\n    Fall: {\r\n      whole: [\r\n        {x: 9, y: 15, w: 37, h: 29}\r\n      ],\r\n      body: [\r\n        {x: 23, y: 15, w: 17, h: 27}\r\n      ]\r\n    },\r\n    Ground: {\r\n      whole: [\r\n        {x: 9, y: 20, w: 37, h: 25}\r\n      ],\r\n      body: [\r\n        {x: 22, y: 20, w: 19, h: 24}\r\n      ]\r\n    },\r\n    Hit: {\r\n      whole: [\r\n        {x: 7, y: 15, w: 37, h: 25},\r\n        {x: 8, y: 15, w: 37, h: 26}\r\n      ]\r\n    },\r\n    Idle: {\r\n      whole: [\r\n        {x: 9, y: 18, w: 37, h: 26},\r\n        {x: 9, y: 18, w: 37, h: 26},\r\n        {x: 9, y: 18, w: 37, h: 26},\r\n        {x: 9, y: 18, w: 37, h: 26},\r\n        {x: 9, y: 18, w: 37, h: 26},\r\n        {x: 9, y: 18, w: 37, h: 26},\r\n        {x: 9, y: 17, w: 37, h: 27},\r\n        {x: 9, y: 16, w: 37, h: 28},\r\n        {x: 9, y: 16, w: 37, h: 28},\r\n        {x: 9, y: 17, w: 37, h: 27},\r\n        {x: 9, y: 18, w: 37, h: 26}\r\n      ],\r\n      body: [\r\n        {x: 23, y: 18, w: 18, h: 26},\r\n        {x: 23, y: 18, w: 18, h: 26},\r\n        {x: 23, y: 18, w: 18, h: 26},\r\n        {x: 23, y: 18, w: 18, h: 26},\r\n        {x: 23, y: 18, w: 18, h: 26},\r\n        {x: 23, y: 18, w: 18, h: 26},\r\n        {x: 23, y: 17, w: 17, h: 27},\r\n        {x: 23, y: 16, w: 17, h: 28},\r\n        {x: 23, y: 16, w: 17, h: 28},\r\n        {x: 23, y: 17, w: 17, h: 27},\r\n        {x: 23, y: 18, w: 17, h: 27}\r\n      ]\r\n    },\r\n    Jump: {\r\n      whole: [\r\n        {x: 9, y: 15, w: 37, h: 29}\r\n      ],\r\n      body: [\r\n        {x: 23, y: 15, w: 17, h: 27}\r\n      ]\r\n    },\r\n    Run: {\r\n      whole: [\r\n        {x: 9, y: 18, w: 37, h: 25},\r\n        {x: 9, y: 16, w: 37, h: 26},\r\n        {x: 9, y: 17, w: 37, h: 26},\r\n        {x: 9, y: 20, w: 37, h: 25},\r\n        {x: 9, y: 18, w: 37, h: 25},\r\n        {x: 9, y: 16, w: 37, h: 26},\r\n        {x: 9, y: 17, w: 37, h: 26},\r\n        {x: 9, y: 20, w: 37, h: 25}\r\n      ],\r\n      body: [\r\n        {x: 23, y: 18, w: 17, h: 23},\r\n        {x: 23, y: 16, w: 17, h: 24},\r\n        {x: 23, y: 17, w: 17, h: 24},\r\n        {x: 23, y: 20, w: 17, h: 23},\r\n        {x: 23, y: 18, w: 17, h: 24},\r\n        {x: 23, y: 17, w: 17, h: 25},\r\n        {x: 23, y: 17, w: 17, h: 25},\r\n        {x: 23, y: 20, w: 17, h: 23}\r\n      ]\r\n    }\r\n  },\r\n  'King Pig': {\r\n    Attack: {\r\n      whole: [\r\n        {x: 9, y: 9, w: 20, h: 19},\r\n        {x: 9, y: 10, w: 20, h: 18},\r\n        {x: 0, y: 0, w: 28, h: 23},\r\n        {x: 3, y: 0, w: 25, h: 23},\r\n        {x: 9, y: 9, w: 20, h: 19}\r\n      ],\r\n      body: [\r\n        {x: 9, y: 12, w: 20, h: 16},\r\n        {x: 9, y: 12, w: 20, h: 16},\r\n        {x: 9, y: 6, w: 19, h: 17},\r\n        {x: 10, y: 7, w: 18, h: 17},\r\n        {x: 9, y: 13, w: 20, h: 15}\r\n      ],\r\n      attack: [\r\n        null, null,\r\n        {x: 0, y: 2, w: 9, h: 21},\r\n        [{x: 4, y: 0, w: 8, h: 6}, {x: 4, y: 6, w: 2, h: 4}]\r\n      ]\r\n    },\r\n    Dead: {\r\n      whole: [\r\n        {x: 10, y: 7, w: 19, h: 21},\r\n        {x: 13, y: 12, w: 22, h: 16},\r\n        {x: 14, y: 13, w: 23, h: 15},\r\n        {x: 16, y: 12, w: 21, h: 16}\r\n      ]\r\n    },\r\n    Fall: {\r\n      whole: [\r\n        {x: 9, y: 6, w: 19, h: 22}\r\n      ],\r\n      body: [\r\n        {x: 10, y: 10, w: 18, h: 18}\r\n      ]\r\n    },\r\n    Ground: {\r\n      whole: [\r\n        {x: 9, y: 9, w: 20, h: 19}\r\n      ],\r\n      body: [\r\n        {x: 9, y: 13, w: 20, h: 15}\r\n      ]\r\n    },\r\n    Hit: {\r\n      whole: [\r\n        {x: 11, y: 3, w: 18, h: 21},\r\n        {x: 10, y: 5, w: 18, h: 21}\r\n      ]\r\n    },\r\n    Idle: {\r\n      whole: [\r\n        {x: 10, y: 8, w: 18, h: 20},\r\n        {x: 10, y: 8, w: 18, h: 20},\r\n        {x: 10, y: 8, w: 18, h: 20},\r\n        {x: 10, y: 8, w: 18, h: 20},\r\n        {x: 10, y: 8, w: 18, h: 20},\r\n        {x: 10, y: 8, w: 18, h: 20},\r\n        {x: 10, y: 8, w: 18, h: 20},\r\n        {x: 10, y: 7, w: 18, h: 21},\r\n        {x: 10, y: 5, w: 18, h: 23},\r\n        {x: 9, y: 6, w: 19, h: 22},\r\n        {x: 9, y: 7, w: 19, h: 21},\r\n        {x: 10, y: 9, w: 18, h: 19}\r\n      ],\r\n      body: [\r\n        {x: 11, y: 11, w: 16, h: 17},\r\n        {x: 11, y: 11, w: 16, h: 17},\r\n        {x: 11, y: 11, w: 16, h: 17},\r\n        {x: 11, y: 11, w: 16, h: 17},\r\n        {x: 11, y: 11, w: 16, h: 17},\r\n        {x: 11, y: 11, w: 16, h: 17},\r\n        {x: 11, y: 11, w: 16, h: 17},\r\n        {x: 11, y: 10, w: 16, h: 18},\r\n        {x: 11, y: 9, w: 16, h: 19},\r\n        {x: 11, y: 11, w: 16, h: 17},\r\n        {x: 11, y: 12, w: 16, h: 16}\r\n      ]\r\n    },\r\n    Jump: {\r\n      whole: [\r\n        {x: 10, y: 6, w: 18, h: 22}\r\n      ],\r\n      body: [\r\n        {x: 10, y: 10, w: 18, h: 18}\r\n      ]\r\n    },\r\n    Run: {\r\n      whole: [\r\n        {x: 9, y: 6, w: 19, h: 19},\r\n        {x: 9, y: 7, w: 19, h: 20},\r\n        {x: 10, y: 8, w: 18, h: 20},\r\n        {x: 10, y: 6, w: 18, h: 20},\r\n        {x: 10, y: 7, w: 18, h: 20},\r\n        {x: 10, y: 8, w: 18, h: 20}\r\n      ],\r\n      body: [\r\n        {x: 10, y: 11, w: 18, h: 15},\r\n        {x: 10, y: 10, w: 17, h: 17},\r\n        {x: 11, y: 11, w: 16, h: 17},\r\n        {x: 10, y: 10, w: 18, h: 16},\r\n        {x: 10, y: 10, w: 18, h: 17},\r\n        {x: 10, y: 11, w: 18, h: 17}\r\n      ]\r\n    }\r\n  },\r\n  Pig: {\r\n    Attack: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Dead: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Fall: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Ground: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Hit: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Idle: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Jump: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Run: {\r\n      whole: [],\r\n      body: []\r\n    }\r\n  },\r\n  'Pig Throwing a Box': {\r\n    Idle: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    'Picking Box': {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Run: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    'Throwing Box': {\r\n      whole: [],\r\n      body: []\r\n    }\r\n  },\r\n  'Pig Thowing a Bomb': {\r\n    Idle: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    'Picking Bomb': {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Run: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    'Throwing Boom': {\r\n      whole: [],\r\n      body: []\r\n    }\r\n  },\r\n  'Pig Hide in the Box': {\r\n    Fall: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Ground: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Jump: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    'Jump Anticipation': {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    'Looking Out': {\r\n      whole: [],\r\n      body: []\r\n    }\r\n  },\r\n  'Pig With a Match': {\r\n    'Lighting the Cannon': {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    'Lighting the Match': {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    'Match On': {\r\n      whole: [],\r\n      body: []\r\n    }\r\n  },\r\n  Box: {\r\n    'Box Pieces 1': {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    'Box Pieces 2': {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    'Box Pieces 3': {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    'Box Pieces 4': {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Hit: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Idle: {\r\n      whole: [],\r\n      body: []\r\n    }\r\n  },\r\n  Bomb: {\r\n    'Bomb Off': {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    'Bomb On': {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Boooooom: {\r\n      whole: [],\r\n      body: []\r\n    }\r\n  },\r\n  Cannon: {\r\n    'Cannon Ball': {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Idle: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Shoot: {\r\n      whole: [],\r\n      body: []\r\n    }\r\n  },\r\n  Door: {\r\n    Closiong: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Idle: {\r\n      whole: [],\r\n      body: []\r\n    },\r\n    Opening: {\r\n      whole: [],\r\n      body: []\r\n    }\r\n  }\r\n}\r\n\r\nlet resolvedBoxData = resolve(boxData)\r\n\r\nfunction resolve(boxData) {\r\n  let result = {},\r\n      nameOfRoles = Object.keys(boxData)\r\n  for (let nameOfRole of nameOfRoles) {\r\n    let states = boxData[nameOfRole],\r\n        nameOfStates = Object.keys(states)\r\n    if (!result[nameOfRole]) {\r\n      result[nameOfRole] = {}\r\n    }\r\n    for (let nameOfState of nameOfStates) {\r\n      let boxes = states[nameOfState]\r\n      if (!result[nameOfRole][nameOfState]) {\r\n        result[nameOfRole][nameOfState] = {}\r\n      }\r\n      if (boxes.whole && boxes.whole.length) {\r\n        let whole = result[nameOfRole][nameOfState].whole = []\r\n        boxes.whole.forEach(b => whole.push(resolveBox(b)))\r\n      }\r\n      if (boxes.body && boxes.body.length) {\r\n        let body = result[nameOfRole][nameOfState].body = []\r\n        boxes.body.forEach(b => body.push(resolveBox(b)))\r\n      }\r\n      if (boxes.attack && boxes.attack.length) {\r\n        let attack = result[nameOfRole][nameOfState].attack = []\r\n        boxes.attack.forEach(b => attack.push(resolveBox(b)))\r\n      }\r\n    }\r\n  }\r\n  return result\r\n}\r\n\r\nfunction resolveBox(box) {\r\n  if (Array.isArray(box)) {\r\n    return box.map(b => {\r\n      return {\r\n        up: b.y,\r\n        right: b.x + b.w,\r\n        down: b.y + b.h,\r\n        left: b.x\r\n      }\r\n    })\r\n  } else if (Object(_utils_js__WEBPACK_IMPORTED_MODULE_0__[\"toType\"])(box) === 'Object') {\r\n    return {\r\n      up: box.y,\r\n      right: box.x + box.w,\r\n      down: box.y + box.h,\r\n      left: box.x\r\n    }\r\n  } else if (box === null) {\r\n    return box\r\n  } else {\r\n    throw new Error('Failed in resolving box: Box should be array, object or null.')\r\n  }\r\n}\n\n//# sourceURL=webpack:///./scripts/boxData.js?");

/***/ }),

/***/ "./scripts/control.js":
/*!****************************!*\
  !*** ./scripts/control.js ***!
  \****************************/
/*! exports provided: InputHandler, throttledInputHandler */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"InputHandler\", function() { return InputHandler; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"throttledInputHandler\", function() { return throttledInputHandler; });\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ \"./scripts/utils.js\");\n/*  Encapsulate a request as an object, thereby letting users parameterize clients with different requests, \r\n *  queue or log requests, and support undoable operations.\r\n *\r\n *  鼠标相关的程序未实现\r\n */\r\n\r\n\r\n\r\nconst BUTTON_ARROW_UP = 'ArrowUp'\r\nconst BUTTON_ARROW_RIGHT = 'ArrowRight'\r\nconst BUTTON_ARROW_DOWN = 'ArrowDown'\r\nconst BUTTON_ARROW_LEFT = 'ArrowLeft'\r\n\r\n// enable keyboard configuration\r\n\r\nlet button_up = 'w',\r\n    button_right = 'd',\r\n    button_down = 's',\r\n    button_left = 'a',\r\n    button_attack = 'j',\r\n    button_dorge = 'k'\r\n\r\n// arrays\r\n\r\nlet mouseMoveControl = ['mousemove', 'mouseenter', 'mouseleave'],\r\n    mouseClickControl = ['mousedown', 'mouseup', 'click'],\r\n    keyboardControl = ['keydown', 'keyup', 'keypress']\r\n\r\n// Command class\r\n\r\nconst Command = _utils_js__WEBPACK_IMPORTED_MODULE_0__[\"AbstractConstructor\"].extend(function (command, type) {\r\n  this.command = command\r\n  this.type = type\r\n})\r\n\r\n/*\r\nconst JumpCommand = Command.extend(function () {\r\n  this.execute = (actor) => { actor.jump() }\r\n})\r\n\r\nconst AttackCommand = Command.extend(function () {\r\n  this.execute = (actor) => { actor.attack() }\r\n})\r\n\r\nconst MoveUnitCommand = (unit, x, y) => {\r\n  var xBefore, yBefore\r\n  return {\r\n    execute () {\r\n      xBefore = x\r\n      yBefore = y\r\n      unit.moveTo(x, y)\r\n    },\r\n    undo () {\r\n      unit.moveTo(xBefore, yBefore)\r\n    }\r\n  }\r\n}\r\n*/\r\n\r\n// input handler\r\n\r\nconst a = function (actor, type, e) {\r\n  if (e.button === 0) {\r\n    // to be supplemented\r\n  }\r\n}\r\n\r\nconst b = function (actor, type, e) {\r\n  /**\r\n   * if (e.key === button_up || e.key === BUTTON_ARROW_UP) { actor.handleInput(InputHandler['_' + type + direction[0]]) }\r\n   * else if (e.key === button_right || e.key === BUTTON_ARROW_RIGHT) { actor.handleInput(InputHandler['_' + type + direction[1]]) }\r\n   * else if (e.key === button_down || e.key === BUTTON_ARROW_DOWN) { actor.handleInput(InputHandler['_' + type + direction[2]]) }\r\n   * else if (e.key === button_left || e.key === BUTTON_ARROW_LEFT) { actor.handleInput(InputHandler['_' + type + direction[3]]) }\r\n   * else if (e.key === button_attack) { actor.handleInput(InputHandler._attack_) }\r\n   * else if (e.key === button_dorge) { actor.handleInput(InputHandler._dorge_) }\r\n   */\r\n  switch (e.key) {\r\n    case button_up:\r\n    case BUTTON_ARROW_UP:\r\n      actor.handleInput(InputHandler['_' + type + direction[0]])\r\n      break\r\n    case button_right:\r\n    case BUTTON_ARROW_RIGHT:\r\n      actor.handleInput(InputHandler['_' + type + direction[1]])\r\n      break\r\n    case button_down:\r\n    case BUTTON_ARROW_DOWN:\r\n      actor.handleInput(InputHandler['_' + type + direction[2]])\r\n      break\r\n    case button_left:\r\n    case BUTTON_ARROW_LEFT:\r\n      actor.handleInput(InputHandler['_' + type + direction[3]])\r\n      break\r\n    case button_attack:\r\n      actor.handleInput(InputHandler._attack_)\r\n      break\r\n    case button_dorge:\r\n      actor.handleInput(InputHandler._dorge_)\r\n      break\r\n  }\r\n}\r\n\r\n// 针对一种事件，创建一种InputHandler, 绑定角色和事件类型\r\nfunction InputHandler (actor, type) {\r\n  if (mouseClickControl.indexOf(type) !== -1) {\r\n    return a.bind(actor, type)\r\n  } else if (keyboardControl.indexOf(type) !== -1) {\r\n    return b.bind(actor, type)\r\n  } else if (mouseMoveControl.indexOf(type) !== -1) {\r\n    // to be supplemented\r\n  }\r\n}\r\n\r\n// 无法控制事件触发频率，就控制回调函数的执行频率\r\nfunction throttledInputHandler(actor, inputType, throttleType) {\r\n  return throttle(InputHandler(actor, inputType), MS_PER_UPDATE, throttleType)\r\n}\r\n\r\n// commands e.g. InputHandler._keydown_buttonUp_ --> new MoveCommand('keydown_buttonUp_', 'keydown')\r\n\r\nlet buttons = ['_buttonUp_', '_buttonRight_', '_buttonDown_', '_buttonLeft_']\r\n\r\nfor (let control of keyboardControl) {\r\n  for (let button of buttons) {\r\n    let command = '_' + control + button,\r\n        dir\r\n    button === '_buttonRight_'\r\n      ? dir = 'right'\r\n      : button === '_buttonLeft_'\r\n        ? dir = 'left'\r\n        : 'else'\r\n    InputHandler[command] = new Command(dir, control)\r\n  }\r\n}\r\n\r\nInputHandler._attack_ = new Command('_attack_', 'keydown')\r\nInputHandler._dorge_ = new Command('_dorge_', 'keydown')\n\n//# sourceURL=webpack:///./scripts/control.js?");

/***/ }),

/***/ "./scripts/game.js":
/*!*************************!*\
  !*** ./scripts/game.js ***!
  \*************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _stage_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./stage.js */ \"./scripts/stage.js\");\n/* harmony import */ var _map_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./map.js */ \"./scripts/map.js\");\n/* harmony import */ var _levelManager_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./levelManager.js */ \"./scripts/levelManager.js\");\n/* harmony import */ var _sequencing_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./sequencing.js */ \"./scripts/sequencing.js\");\n/* harmony import */ var _control_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./control.js */ \"./scripts/control.js\");\n\r\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n  stage: undefined,\r\n  player: undefined,\r\n  init () {\r\n    this.stage = new _stage_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]({\r\n      backgroundId: 'back',\r\n      id: 'mainStage',\r\n      anti_aliasing: false\r\n    })\r\n    let inputHandler = {\r\n      onKeyDown: Object(_control_js__WEBPACK_IMPORTED_MODULE_4__[\"throttledInputHandler\"])(this.player, 'keydown', 1),\r\n      onKeyUp: Object(_control_js__WEBPACK_IMPORTED_MODULE_4__[\"throttledInputHandler\"])(this.player, 'keyup', 1),\r\n      onKeyPress: Object(_control_js__WEBPACK_IMPORTED_MODULE_4__[\"throttledInputHandler\"])(this.player, 'keypress', 1)\r\n    }\r\n    this.stage.installInputHandler(inputHandler, this.stage.canvas)\r\n  },\r\n  start () {\r\n    _levelManager_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].init(0)\r\n    _map_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].computeRenderOffset()\r\n    _map_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].render()\r\n\r\n    Object(_sequencing_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])()\r\n    requestAnimationFrame(_sequencing_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])\r\n  },\r\n  setPlayer (role) {\r\n    this.player = role\r\n  }\r\n});\r\n\n\n//# sourceURL=webpack:///./scripts/game.js?");

/***/ }),

/***/ "./scripts/index.js":
/*!**************************!*\
  !*** ./scripts/index.js ***!
  \**************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _loader_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./loader.js */ \"./scripts/loader.js\");\n\r\n_loader_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].load()\n\n//# sourceURL=webpack:///./scripts/index.js?");

/***/ }),

/***/ "./scripts/levelManager.js":
/*!*********************************!*\
  !*** ./scripts/levelManager.js ***!
  \*********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ \"./scripts/utils.js\");\n/* harmony import */ var _sequencing_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./sequencing.js */ \"./scripts/sequencing.js\");\n/* harmony import */ var _metaMap_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./metaMap.js */ \"./scripts/metaMap.js\");\n/* harmony import */ var _obstacle_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./obstacle.js */ \"./scripts/obstacle.js\");\n\r\n\r\n\r\n\r\n\r\nlet uid = 0\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n  n: undefined,\r\n  map: undefined,\r\n  init (level) {\r\n    this.n = level\r\n    level = this.level[level]\r\n    // 将关卡地图信息注入om.tileDatabase\r\n    let map = this.map = level['map']\r\n    map.layers.forEach((layer) => {\r\n      if (/terrain/.test(layer.name)) {\r\n        let data = layer.data\r\n        for (let tileY = 0, len = layer.height; tileY < len; tileY++) {\r\n          for (let tileX = 0, len = layer.width; tileX < len; tileX++) {\r\n            let texture = data[tileY][tileX]\r\n            if (texture !== 0) {\r\n              _obstacle_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].addTile(texture, tileX, tileY)\r\n              // inject physicsBox into tiles\r\n              let W = map.tileWidth,\r\n                  H = map.tileHeight,\r\n                  tile = _obstacle_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].tileDatabase[tileY][tileX]['tile'],\r\n                  x = tileX * W,\r\n                  y = tileY * H,\r\n                  w = tile.w_obsfraction * W,\r\n                  h = tile.h_obsfraction * H\r\n              _obstacle_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].tileDatabase[tileY][tileX]['physicsBox'] = {\r\n                left: x,\r\n                top: y,\r\n                right: x + w,\r\n                bottom: y + h\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    })\r\n    /**\r\n     * 如果是玩家角色，只注入坐标信息\r\n     * 非玩家角色则根据states属性实例化，并注入坐标信息\r\n     */\r\n    let keys = Object.keys(level.roles)\r\n    keys.forEach((role) => {\r\n      let info = level.roles[role]\r\n      if (Array.isArray(info)) {\r\n        if (role = player.assetName) { // 是玩家角色\r\n          player.uid = uid++\r\n          player.x = info.x\r\n          player.y = info.y\r\n          _sequencing_js__WEBPACK_IMPORTED_MODULE_1__[\"roleArray\"].push(player)\r\n        } else { // 多个非玩家角色\r\n          info.forEach((coor) => {\r\n            let role = this.generateRole(coor, role)\r\n            _sequencing_js__WEBPACK_IMPORTED_MODULE_1__[\"roleArray\"].push(role)\r\n          })\r\n        }\r\n      } else if (Object(_utils_js__WEBPACK_IMPORTED_MODULE_0__[\"toType\"])(info) === \"Object\") { // 单个非玩家角色\r\n        let role = this.generateRole(coor, role)\r\n        _sequencing_js__WEBPACK_IMPORTED_MODULE_1__[\"roleArray\"].push(role)\r\n      } else {\r\n        throw new Error('Info should be array or object type.')\r\n      }\r\n    })\r\n  },\r\n  // 关卡信息\r\n  level: [\r\n    {\r\n      name: 'test',\r\n      map: _metaMap_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"][0],\r\n      roles: {\r\n        'King Human': {\r\n          x: 0,\r\n          y: 0\r\n        },\r\n        /**\r\n        door: {\r\n          x: 0,\r\n          y: 0\r\n        },\r\n        'King Pig': {\r\n          x: 0,\r\n          y: 0\r\n        }\r\n         */\r\n      }\r\n    },\r\n  ],\r\n  generateRole (coor, assetName) {\r\n    let role = new Role({\r\n      assetName,\r\n      state: 'idle', // enter state\r\n      dir: Math.random() > 0.5 ? 'right' : 'left', // 随机朝向\r\n    })\r\n    // 检查是否与地图重合\r\n    let wholeArea = role.physicsBox.wholeArea,\r\n        leftTop = { x: wholeArea.x, y: wholeArea.y },\r\n        rightTop = { x: wholeArea.x + wholeArea.w, y: wholeArea.y },\r\n        leftBottom = { x: wholeArea.x, y: wholeArea.y + wholeArea.h },\r\n        rightBottom = { x: wholeArea.x + wholeArea.w, y: wholeArea.y + wholeArea.h}\r\n\r\n    role.coor = { // 角色左上角在地图的位置\r\n      x: coor.x,\r\n      y: coor.y\r\n    }\r\n    role.uid = uid++\r\n    return role\r\n  }\r\n});\r\n\n\n//# sourceURL=webpack:///./scripts/levelManager.js?");

/***/ }),

/***/ "./scripts/loader.js":
/*!***************************!*\
  !*** ./scripts/loader.js ***!
  \***************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ \"./scripts/utils.js\");\n/* harmony import */ var _UI_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./UI.js */ \"./scripts/UI.js\");\n/* harmony import */ var _role_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./role.js */ \"./scripts/role.js\");\n/* harmony import */ var _game_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./game.js */ \"./scripts/game.js\");\n!(function webpackMissingModule() { var e = new Error(\"Cannot find module 'fs'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }());\n\r\n\r\n\r\n\r\n\r\n!(function webpackMissingModule() { var e = new Error(\"Cannot find module 'fs'\"); e.code = 'MODULE_NOT_FOUND'; throw e; }()).readdirSync('.', 'utf-8', function(err, data) {\r\n  console.log(data)\r\n})\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n  total: 0,\r\n  complished: 0,\r\n  assets: {\r\n    sprite: {},\r\n    se: {},\r\n    bgm: {}\r\n  },\r\n  src: {\r\n    sprite: {\r\n      'King Human': {\r\n        Attack: {\r\n          src: './assets/Sprites/01-King Human/Attack (78x58).png',\r\n          width: 78,\r\n          height: 58\r\n        },\r\n        Dead: {\r\n          src: './assets/Sprites/01-King Human/Dead (78x58).png',\r\n          width: 78,\r\n          height: 58\r\n        },\r\n        'Door In': {\r\n          src: './assets/Sprites/01-King Human/Door In (78x58).png',\r\n          width: 78,\r\n          height: 58\r\n        },\r\n        'Door Out': {\r\n          src: './assets/Sprites/01-King Human/Door Out (78x58).png',\r\n          width: 78,\r\n          height: 58\r\n        },\r\n        Fall: {\r\n          src: './assets/Sprites/01-King Human/Fall (78x58).png',\r\n          width: 78,\r\n          height: 58\r\n        },\r\n        Ground: {\r\n          src: './assets/Sprites/01-King Human/Ground (78x58).png',\r\n          width: 78,\r\n          height: 58\r\n        },\r\n        Hit: {\r\n          src: './assets/Sprites/01-King Human/Hit (78x58).png',\r\n          width: 78,\r\n          height: 58\r\n        },\r\n        Idle: {\r\n          src: './assets/Sprites/01-King Human/Idle (78x58).png',\r\n          width: 78,\r\n          height: 58\r\n        },\r\n        Jump: {\r\n          src: './assets/Sprites/01-King Human/Jump (78x58).png',\r\n          width: 78,\r\n          height: 58\r\n        },\r\n        Run: {\r\n          src: './assets/Sprites/01-King Human/Run (78x58).png',\r\n          width: 78,\r\n          height: 58\r\n        }\r\n      },\r\n      'King Pig': {\r\n        Attack: {\r\n          src: './assets/Sprites/02-King Pig/Attack (38x28).png',\r\n          width: 38,\r\n          height: 28\r\n        },\r\n        Dead: {\r\n          src: './assets/Sprites/02-King Pig/Dead (38x28).png',\r\n          width: 38,\r\n          height: 28\r\n        },\r\n        Fall: {\r\n          src: './assets/Sprites/02-King Pig/Fall (38x28).png',\r\n          width: 38,\r\n          height: 28\r\n        },\r\n        Ground: {\r\n          src: './assets/Sprites/02-King Pig/Ground (38x28).png',\r\n          width: 38,\r\n          height: 28\r\n        },\r\n        Hit: {\r\n          src: './assets/Sprites/02-King Pig/Hit (38x28).png',\r\n          width: 38,\r\n          height: 28\r\n        },\r\n        Idle: {\r\n          src: './assets/Sprites/02-King Pig/Idle (38x28).png',\r\n          width: 38,\r\n          height: 28\r\n        },\r\n        Jump: {\r\n          src: './assets/Sprites/02-King Pig/Jump (38x28).png',\r\n          width: 38,\r\n          height: 28\r\n        },\r\n        Run: {\r\n          src: './assets/Sprites/02-King Pig/Run (38x28).png',\r\n          width: 38,\r\n          height: 28\r\n        }\r\n      },\r\n      Pig: {\r\n        Attack: {\r\n          src: './assets/Sprites/03-Pig/Attack (34x28).png',\r\n          width: 34,\r\n          height: 28\r\n        },\r\n        Dead: {\r\n          src: './assets/Sprites/03-Pig/Dead (34x28).png',\r\n          width: 34,\r\n          height: 28\r\n        },\r\n        Fall: {\r\n          src: './assets/Sprites/03-Pig/Fall (34x28).png',\r\n          width: 34,\r\n          height: 28\r\n        },\r\n        Ground: {\r\n          src: './assets/Sprites/03-Pig/Ground (34x28).png',\r\n          width: 34,\r\n          height: 28\r\n        },\r\n        Hit: {\r\n          src: './assets/Sprites/03-Pig/Hit (34x28).png',\r\n          width: 34,\r\n          height: 28\r\n        },\r\n        Idle: {\r\n          src: './assets/Sprites/03-Pig/Idle (34x28).png',\r\n          width: 34,\r\n          height: 28\r\n        },\r\n        Jump: {\r\n          src: './assets/Sprites/03-Pig/Jump (34x28).png',\r\n          width: 34,\r\n          height: 28\r\n        },\r\n        Run: {\r\n          src: './assets/Sprites/03-Pig/Run (34x28).png',\r\n          width: 34,\r\n          height: 28\r\n        }\r\n      },\r\n      'Pig Throwing a Box': {\r\n        Idle: {\r\n          src: './assets/Sprites/04-Pig Throwing a Box/Idle (26x30).png',\r\n          width: 26,\r\n          height: 30\r\n        },\r\n        'Picking Box': {\r\n          src: './assets/Sprites/04-Pig Throwing a Box/Picking Box (26x30).png',\r\n          width: 26,\r\n          height: 30\r\n        },\r\n        Run: {\r\n          src: './assets/Sprites/04-Pig Throwing a Box/Run (26x30).png',\r\n          width: 26,\r\n          height: 30\r\n        },\r\n        'Throwing Box': {\r\n          src: './assets/Sprites/04-Pig Throwing a Box/Throwing Box (26x30).png',\r\n          width: 26,\r\n          height: 30\r\n        }\r\n      },\r\n      'Pig Thowing a Bomb': {\r\n        Idle: {\r\n          src: './assets/Sprites/05-Pig Thowing a Bomb/Idle (26x26).png',\r\n          width: 26,\r\n          height: 26\r\n        },\r\n        'Picking Bomb': {\r\n          src: './assets/Sprites/05-Pig Thowing a Bomb/Picking Bomb (26x26).png',\r\n          width: 26,\r\n          height: 26\r\n        },\r\n        Run: {\r\n          src: './assets/Sprites/05-Pig Thowing a Bomb/Run (26x26).png',\r\n          width: 26,\r\n          height: 26\r\n        },\r\n        'Throwing Boom': {\r\n          src: './assets/Sprites/05-Pig Thowing a Bomb/Throwing Boom (26x26).png',\r\n          width: 26,\r\n          height: 26\r\n        }\r\n      },\r\n      'Pig Hide in the Box': {\r\n        Fall: {\r\n          src: './assets/Sprites/06-Pig Hide in the Box/Fall (26x20).png',\r\n          width: 26,\r\n          height: 20\r\n        },\r\n        Ground: {\r\n          src: './assets/Sprites/06-Pig Hide in the Box/Ground (26x20).png',\r\n          width: 26,\r\n          height: 20\r\n        },\r\n        Jump: {\r\n          src: './assets/Sprites/06-Pig Hide in the Box/Jump (26x20).png',\r\n          width: 26,\r\n          height: 20\r\n        },\r\n        'Jump Anticipation': {\r\n          src: './assets/Sprites/06-Pig Hide in the Box/Jump Anticipation (26x20).png',\r\n          width: 26,\r\n          height: 20\r\n        },\r\n        'Looking Out': {\r\n          src: './assets/Sprites/06-Pig Hide in the Box/Looking Out (26x20).png',\r\n          width: 26,\r\n          height: 20\r\n        }\r\n      },\r\n      'Pig With a Match': {\r\n        'Lighting the Cannon': {\r\n          src: './assets/Sprites/07-Pig With a Match/Lighting the Cannon (26x18).png',\r\n          width: 26,\r\n          height: 18\r\n        },\r\n        'Lighting the Match': {\r\n          src: './assets/Sprites/07-Pig With a Match/Lighting the Match (26x18).png',\r\n          width: 26,\r\n          height: 18\r\n        },\r\n        'Match On': {\r\n          src: './assets/Sprites/07-Pig With a Match/Match On (26x18).png',\r\n          width: 26,\r\n          height: 18\r\n        }\r\n      },\r\n      Box: {\r\n        'Box Pieces 1': {\r\n          src: './assets/Sprites/08-Box/Box Pieces 1 (10x10).png',\r\n          width: 10,\r\n          height: 10\r\n        },\r\n        'Box Pieces 2': {\r\n          src: './assets/Sprites/08-Box/Box Pieces 2 (10x10).png',\r\n          width: 10,\r\n          height: 10\r\n        },\r\n        'Box Pieces 3': {\r\n          src: './assets/Sprites/08-Box/Box Pieces 3 (10x10).png',\r\n          width: 10,\r\n          height: 10\r\n        },\r\n        'Box Pieces 4': {\r\n          src: './assets/Sprites/08-Box/Box Pieces 4 (10x10).png',\r\n          width: 10,\r\n          height: 10\r\n        },\r\n        Hit: {\r\n          src: './assets/Sprites/08-Box/Hit (22x16).png',\r\n          width: 22,\r\n          height: 16\r\n        },\r\n        Idle: {\r\n          src: './assets/Sprites/08-Box/Idle (22x16).png',\r\n          width: 22,\r\n          height: 16\r\n        }\r\n      },\r\n      Bomb: {\r\n        'Bomb Off': {\r\n          src: './assets/Sprites/09-Bomb/Bomb Off (52x56).png',\r\n          width: 52,\r\n          height: 56\r\n        },\r\n        'Bomb On': {\r\n          src: './assets/Sprites/09-Bomb/Bomb On (52x56).png',\r\n          width: 52,\r\n          height: 56\r\n        },\r\n        Boooooom: {\r\n          src: './assets/Sprites/09-Bomb/Boooooom (52x56).png',\r\n          width: 52,\r\n          height: 56\r\n        }\r\n      },\r\n      Cannon: {\r\n        'Cannon Ball': {\r\n          src: './assets/Sprites/10-Cannon/Cannon Ball (44x28).png',\r\n          width: 44,\r\n          height: 28\r\n        },\r\n        Idle: {\r\n          src: './assets/Sprites/10-Cannon/Idle (44x28).png',\r\n          width: 44,\r\n          height: 28\r\n        },\r\n        Shoot: {\r\n          src: './assets/Sprites/10-Cannon/Shoot (44x28).png',\r\n          width: 44,\r\n          height: 28\r\n        }\r\n      },\r\n      Door: {\r\n        Closiong: {\r\n          src: './assets/Sprites/11-Door/Closiong (46x56).png',\r\n          width: 46,\r\n          height: 56\r\n        },\r\n        Idle: {\r\n          src: './assets/Sprites/11-Door/Idle (46x56).png',\r\n          width: 46,\r\n          height: 56\r\n        },\r\n        Opening: {\r\n          src: './assets/Sprites/11-Door/Opening (46x56).png',\r\n          width: 46,\r\n          height: 56\r\n        }\r\n      },\r\n      'Live and Coins': {\r\n        'Big Diamond Hit': {\r\n          src: './assets/Sprites/12-Live and Coins/Big Diamond Hit (18x14).png',\r\n          width: 18,\r\n          height: 14\r\n        },\r\n        'Big Diamond Idle': {\r\n          src: './assets/Sprites/12-Live and Coins/Big Diamond Idle (18x14).png',\r\n          width: 18,\r\n          height: 14\r\n        },\r\n        'Big Heart Hit': {\r\n          src: './assets/Sprites/12-Live and Coins/Big Heart Hit (18x14).png',\r\n          width: 18,\r\n          height: 14\r\n        },\r\n        'Big Heart Idle': {\r\n          src: './assets/Sprites/12-Live and Coins/Big Heart Idle (18x14).png',\r\n          width: 18,\r\n          height: 14\r\n        },\r\n        'Live Bar': {\r\n          src: './assets/Sprites/12-Live and Coins/Live Bar (66x34).png',\r\n          width: 66,\r\n          height: 34\r\n        },\r\n        Numbers: {\r\n          src: './assets/Sprites/12-Live and Coins/Numbers (6x8).png',\r\n          width: 6,\r\n          height: 8\r\n        },\r\n        'Small Diamond': {\r\n          src: './assets/Sprites/12-Live and Coins/Small Diamond (18x14).png',\r\n          width: 18,\r\n          height: 14\r\n        },\r\n        'Small Heart Hit': {\r\n          src: './assets/Sprites/12-Live and Coins/Small Heart Hit (18x14).png',\r\n          width: 18,\r\n          height: 14\r\n        },\r\n        'Small Heart Idle': {\r\n          src: './assets/Sprites/12-Live and Coins/Small Heart Idle (18x14).png',\r\n          width: 18,\r\n          height: 14\r\n        }\r\n      },\r\n      'Dialogue Boxes': {\r\n        '!!! In': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/!!! In (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        '!!! Out': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/!!! Out (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'Attack In': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/Attack In (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'Attack Out': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/Attack Out (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'Boom In': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/Boom In (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'Boom Out': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/Boom Out (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'Dead In': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/Dead In (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'Dead Out': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/Dead Out (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'Hello In': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/Hello In (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'Hello Out': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/Hello Out (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'Hi In': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/Hi In (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'Hi Out': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/Hi Out (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'Interrogation In': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/Interrogation In (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'Interrogation Out': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/Interrogation Out (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'Loser In': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/Loser In (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'Loser Out': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/Loser Out (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'No In': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/No In (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'No Out': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/No Out (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'WTF In': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/WTF In (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        },\r\n        'WTF Out': {\r\n          src: './assets/Sprites/13-Dialogue Boxes/WTF Out (24x8).png',\r\n          width: 24,\r\n          height: 8\r\n        }\r\n      },\r\n      TileSets: {\r\n        Decorations: {\r\n          src: './assets/Sprites/14-TileSets/Decorations (32x32).png',\r\n          width: 32,\r\n          height: 32\r\n        },\r\n        Terrain: {\r\n          src: './assets/Sprites/14-TileSets/Terrain (32x32).png',\r\n          width: 32,\r\n          height: 32\r\n        }\r\n      }\r\n    },\r\n    se: {\r\n      \r\n    },\r\n    bgm: {\r\n\r\n    }\r\n  },\r\n  loadSprite () {\r\n    let sprite = this.src.sprite,\r\n        roleSprite\r\n    for (let role in sprite) {\r\n      if (!this.assets.sprite[role]) {\r\n        roleSprite = this.assets.sprite[role] = {}\r\n      }\r\n      for (let state in sprite[role]) {\r\n        let img = new Image()\r\n        this.total++\r\n        Object(_utils_js__WEBPACK_IMPORTED_MODULE_0__[\"addEvent\"])(img, 'load', this.onloaded)\r\n        let src = __webpack_require__(\"./scripts sync recursive\")(sprite[role][state].src)\r\n        img.src = src\r\n        roleSprite[state] = img\r\n      }\r\n    }\r\n  },\r\n  loadSE () {\r\n    let SE = this.src.se\r\n    for (let role in SE) {\r\n      if (!this.assets.se[role]) {\r\n        this.assets.se[role] = {}\r\n      }\r\n      for (let state in se[role]) {\r\n        let se = new Audio()\r\n        this.total++\r\n        Object(_utils_js__WEBPACK_IMPORTED_MODULE_0__[\"addEvent\"])(se, 'canplaythrough', this.onloaded)\r\n        se.src = SE[role][state]\r\n        this.assets.se[role][state] = se\r\n      }\r\n    }\r\n  },\r\n  loadBGM () {\r\n    let BGM = this.src.bgm\r\n    for (let stage in BGM) {\r\n      let bgm = new Audio()\r\n      this.total++\r\n      Object(_utils_js__WEBPACK_IMPORTED_MODULE_0__[\"addEvent\"])(bgm, 'canplaythrough', this.onloaded)\r\n      bgm.src = BGM[stage]\r\n      this.assets.bgm[stage] = bgm\r\n    }\r\n  },\r\n  load () {\r\n    // loading screen\r\n    _UI_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].showScreen(_UI_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].loadingScreen)\r\n    this.loadSprite()\r\n    this.loadSE()\r\n    this.loadBGM()\r\n  },\r\n  onloaded (e) {\r\n    e = e || window.event\r\n    let target = e.target || e.srcElement\r\n    \r\n    Object(_utils_js__WEBPACK_IMPORTED_MODULE_0__[\"removeEvent\"])(target, e.type, this.onloaded)\r\n    if (++loader.complished === loader.total) {\r\n      let SPRITE = loader.assets.sprite\r\n      let SE = loader.assets.se\r\n      let BGM = loader.assets.bgm\r\n      for (let role in SPRITE) {\r\n        for (let state in SPRITE[role]) {\r\n          let spriteImg = SPRITE[role][state]\r\n          let srcState = loader.src.sprite[role][state]\r\n          let roleBox = boxData[role] && boxData[role][state]\r\n          SPRITE[role][state] = {\r\n            sprite: spriteImg,\r\n            frame: spriteImg.width / srcState.width,\r\n            width: srcState.width,\r\n            height: srcState.height\r\n          }\r\n        }\r\n      }\r\n      for (let role in SE) {\r\n        for (let state in SE[role]) {\r\n          let se = SE[role][state]\r\n          SE[role][state] = {\r\n            audio: se,\r\n            time: se.played.end()\r\n          }\r\n        }\r\n      }\r\n      for (let stage in BGM) {\r\n        let bgm = BGM[stage]\r\n        BGM[stage] = {\r\n          audio: bgm,\r\n          time: se.played.end()\r\n        }\r\n      }\r\n      // init game\r\n      // ui.showScreen(ui.startScreen)\r\n      let king = new _role_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"]({\r\n        assetName: 'King Human',\r\n        state: 'Idle',\r\n        dir: 'right',\r\n        pb: true,\r\n        health: 10,\r\n        energy: 10,\r\n        vx_max: 3,\r\n        self_ax: 1,\r\n        self_vy: 3\r\n      })\r\n      _game_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].setPlayer(king)\r\n      _game_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].init()\r\n      _game_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"].start()\r\n    }\r\n  }\r\n});\n\n//# sourceURL=webpack:///./scripts/loader.js?");

/***/ }),

/***/ "./scripts/map.js":
/*!************************!*\
  !*** ./scripts/map.js ***!
  \************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _levelManager_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./levelManager.js */ \"./scripts/levelManager.js\");\n/* harmony import */ var _game_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./game.js */ \"./scripts/game.js\");\n/* harmony import */ var _loader_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./loader.js */ \"./scripts/loader.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils.js */ \"./scripts/utils.js\");\n\r\n\r\n\r\n\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\r\n  renderXoffset: undefined,\r\n  renderYoffset: undefined,\r\n  computeRenderOffset () {\r\n    let map = _levelManager_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].level[_levelManager_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].n]['map'],\r\n        width = map.tileWidth * map.width,\r\n        height = map.tileHeight * map.height,\r\n        stage = _game_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].stage\r\n    \r\n    // if the map's size is small than canvas's\r\n    if (width < stage.width && height < stage.height) {\r\n      this.renderXoffset = (stage.width - width) / 2\r\n      this.renderYoffset = (stage.height - height) / 2\r\n    }\r\n\r\n    // to be supplymented: if the map is larger than canvas\r\n  },\r\n  render () {\r\n    let layers = _levelManager_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].map.layers,\r\n        tilesets = _levelManager_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].map.tilesets,\r\n        firstgidArray = [],\r\n        sourceArray = []\r\n    tilesets.forEach(tileset => {\r\n      let to = _loader_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].assets.sprite.TileSets[Object(_utils_js__WEBPACK_IMPORTED_MODULE_3__[\"convertFileName\"])(tileset.source)]\r\n      firstgidArray.push(tileset.firstgid)\r\n      sourceArray.push(to)\r\n    })\r\n\r\n    layers.forEach((layer) => {\r\n      if (/foreground/.test(layer.name) !== true) {\r\n        let data = layer.data\r\n        for (let y in data) {\r\n          for (let x in data) {\r\n            let texture = data[y][x],\r\n                n = -1\r\n\r\n            if (texture === 0) continue\r\n            for (let i in firstgidArray) {\r\n              if (firstgidArray[i] > texture) break\r\n              n++\r\n            }\r\n\r\n            let tilesetObj = sourceArray[n]\r\n            let width = tilesetObj.width\r\n            let height = tilesetObj.height\r\n            let ctx = _game_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].stage.bCtx\r\n            let frame = tilesetObj.frame\r\n\r\n            texture -= firstgidArray[n]\r\n            mapXOffset = texture % frame\r\n            mapYOffset = Math.floor(texture / frame)\r\n\r\n            ctx.save()\r\n            ctx.translate(this.renderXoffset, this.renderYoffset)\r\n            ctx.drawImage(tilesetObj.sprite, mapXOffset * width, mapYOffset * height, width, height, x * width, y * height, width, height)\r\n            ctx.restore()\r\n          }\r\n        }\r\n      }\r\n    })\r\n  }\r\n});\n\n//# sourceURL=webpack:///./scripts/map.js?");

/***/ }),

/***/ "./scripts/metaMap.js":
/*!****************************!*\
  !*** ./scripts/metaMap.js ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ([\r\n  {\r\n    width: 13,\r\n    height: 14,\r\n    tileWidth: 32,\r\n    tileHeight: 32,\r\n    tilesets: [\r\n      { firstgid: 1, source: \"Terrain (32x32).tsx\" },\r\n      { firstgid: 248, source: \"Decorations (32x32).tsx\" },\r\n    ],\r\n    layers: [\r\n      {\r\n        name: \"background0\",\r\n        x: 0,\r\n        y: 0,\r\n        width: 13,\r\n        height: 14,\r\n        data: [\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 135, 136, 136, 136, 136, 136, 136, 136, 136, 136, 137, 0],\r\n          [0, 154, 155, 155, 155, 155, 155, 155, 155, 155, 155, 156, 0],\r\n          [0, 154, 155, 155, 155, 155, 155, 155, 155, 155, 155, 156, 0],\r\n          [0, 173, 142, 155, 155, 155, 155, 155, 155, 155, 155, 156, 0],\r\n          [0, 0, 154, 155, 155, 155, 155, 155, 155, 141, 174, 175, 0],\r\n          [0, 135, 161, 155, 155, 155, 155, 155, 155, 156, 0, 0, 0],\r\n          [0, 154, 155, 155, 155, 155, 155, 155, 155, 156, 0, 0, 0],\r\n          [0, 154, 155, 155, 155, 155, 155, 155, 155, 156, 0, 0, 0],\r\n          [0, 154, 155, 155, 155, 155, 155, 155, 155, 156, 0, 0, 0],\r\n          [0, 154, 155, 155, 155, 155, 155, 155, 155, 160, 136, 137, 0],\r\n          [0, 154, 155, 155, 155, 155, 155, 155, 155, 155, 155, 156, 0],\r\n          [0, 173, 174, 174, 174, 174, 174, 174, 174, 174, 174, 175, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n        ],\r\n        opacity: 1,\r\n      },\r\n      {\r\n        name: \"background1\",\r\n        x: 0,\r\n        y: 0,\r\n        width: 13,\r\n        height: 14,\r\n        data: [\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 256, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 263, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 263, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 277, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 273, 274, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 280, 281, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 256, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 263, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 270, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n        ],\r\n        opacity: 1,\r\n      },\r\n      {\r\n        name: \"terrain0\",\r\n        x: 0,\r\n        y: 0,\r\n        width: 13,\r\n        height: 14,\r\n        data: [\r\n          [27, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 60, 28],\r\n          [42, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40],\r\n          [42, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40],\r\n          [42, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40],\r\n          [42, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40],\r\n          [50, 99, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40],\r\n          [42, 0, 0, 0, 0, 0, 0, 0, 0, 0, 21, 22, 47],\r\n          [42, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40, 0, 0],\r\n          [42, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40, 0, 0],\r\n          [42, 0, 0, 0, 0, 0, 0, 0, 0, 0, 59, 60, 28],\r\n          [42, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40],\r\n          [42, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40],\r\n          [42, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40],\r\n          [46, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 47],\r\n        ],\r\n        opacity: 1,\r\n      },\r\n      {\r\n        name: \"terrain1\",\r\n        x: 0,\r\n        y: 0,\r\n        width: 13,\r\n        height: 14,\r\n        data: [\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 257, 258, 258, 259, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 264, 265, 266, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 267, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 264, 265, 266, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 260, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n        ],\r\n        opacity: 1,\r\n      },\r\n      {\r\n        name: \"foreground\",\r\n        x: 0,\r\n        y: 0,\r\n        width: 13,\r\n        height: 14,\r\n        data: [\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 256, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 263, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 256, 0, 0, 0, 270, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 263, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 263, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 270, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n        ],\r\n        opacity: 0.7,\r\n      },\r\n    ],\r\n  },\r\n]);\n\n//# sourceURL=webpack:///./scripts/metaMap.js?");

/***/ }),

/***/ "./scripts/obstacle.js":
/*!*****************************!*\
  !*** ./scripts/obstacle.js ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n// flyweight mode\r\nfunction Tile (texture, w_obsfraction = 0, h_obsfraction = 0, movementCost = 0) {\r\n  this.texture = texture\r\n  this.w_obsfraction = w_obsfraction\r\n  this.h_obsfraction = h_obsfraction\r\n  this.movementCost = movementCost\r\n}\r\n\r\nlet obstacleTexture = [21, 22, 23, 25, 27, 28, 30, 31, 33, 34, 36, 40, 41, 42, 44, 46, 47, 49, 50, 52, 53, 55, 56, 59, 60, 61, 63, 84, 85, 87, 88, 90, 91, 93, 94, 97, 98, 99, 101, 103, 104, 106, 107, 109, 110, 112, 113],\r\n    quaterTexture = [257, 258, 259, 260],\r\n    halfTexture = [264, 265, 266, 267]\r\n\r\nlet tileFactory = (function(){\r\n  let tiles = {}\r\n  return {\r\n    createTile (texture) {\r\n      let tile = tiles.texture\r\n      if (tile) return tile\r\n      else {\r\n        let w_obsfraction, h_obsfraction\r\n        let movementCost = 1\r\n        // 此处省略其他情况，需要时记得添加分支，否则可能造成bug\r\n        if (obstacleTexture.indexOf(texture) > -1) {\r\n          w_obsfraction = 1,\r\n          h_obsfraction = 1\r\n        } else if (quaterTexture.indexOf(texture) > -1) {\r\n          w_obsfraction = 1,\r\n          h_obsfraction = 0.25\r\n        } else if (halfTexture.indexOf(texture) > -1) {\r\n          w_obsfraction = 1,\r\n          h_obsfraction = 0.5\r\n        } else {\r\n          movementCost = 0\r\n        }\r\n        return tiles.texture = new Tile(texture, w_obsfraction, h_obsfraction, movementCost)\r\n      }\r\n    }\r\n  }\r\n})()\r\n\r\nlet ObstacleManager = function(){\r\n  this.tileDatabase = {}\r\n}\r\n\r\nObstacleManager.prototype = {\r\n  addTile (texture, tileX, tileY) {\r\n    let tile = tileFactory.createTile(texture),\r\n      tileDatabase = this.tileDatabase\r\n\r\n    if (!tileDatabase[tileY]) {\r\n      tileDatabase[tileY] = {}\r\n    }\r\n\r\n    tileDatabase[tileY][tileX] = {\r\n      // more property: physicsBox\r\n      tileX,\r\n      tileY,\r\n      tile\r\n    }\r\n  },\r\n  getMovementCost (tileX, tileY) {\r\n    return this.tileDatabase[tileY][tileX][tile].movementCost\r\n  },\r\n  getTexture (tileX, tileY) {\r\n    return this.tileDatabase[tileY][tileX][tile].texture\r\n  },\r\n  clear () {\r\n    this.tileDatabase = {}\r\n  }\r\n}\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (new ObstacleManager());\n\n//# sourceURL=webpack:///./scripts/obstacle.js?");

/***/ }),

/***/ "./scripts/physics.js":
/*!****************************!*\
  !*** ./scripts/physics.js ***!
  \****************************/
/*! exports provided: gravity, default, intersect */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"gravity\", function() { return gravity; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return physicsBox; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"intersect\", function() { return intersect; });\n/* harmony import */ var _boxData_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./boxData.js */ \"./scripts/boxData.js\");\n/* harmony import */ var _levelManager_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./levelManager.js */ \"./scripts/levelManager.js\");\n/* harmony import */ var _obstacle_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./obstacle.js */ \"./scripts/obstacle.js\");\n/**\r\n * 角色使用的physicsBox，角色初始化选项pb为true时启用\r\n */\r\n\r\n\r\n\r\n\r\n\r\nconst gravity = 0.3\r\n\r\n// whole 用于判断是否碰撞地图\r\n\r\nfunction physicsBox(holder, assetName) {\r\n  /* more properties: wholeArea, bodyArea, attackArea and box, which are injected when setArea function rendered */\r\n  this.holder = holder\r\n  this.boxes = _boxData_js__WEBPACK_IMPORTED_MODULE_0__[\"resolvedBoxData\"][assetName]\r\n  this.run()\r\n}\r\n\r\nphysicsBox.prototype = {\r\n  constructor: physicsBox,\r\n  run () {\r\n    let holder = this.holder,\r\n        jumping = false;\r\n    ['whole', 'body', 'attack'].forEach(area => this.setArea(area)) // 更新 wholeArea、 bodyArea 和 attack 属性\r\n    this.setBox() // 根据 wholeArea 更新 box 属性，box 含有的四个属性代表角色的四个边缘在地图上的位置\r\n    holder.vx += holder.ax\r\n    if (holder.vx > holder.vx_max) {\r\n      holder.vx = holder.vx_max\r\n    } else if (holder.vx < -holder.vx_max) {\r\n      holder.vx = -holder.vx_max\r\n    }\r\n    if (holder.vy < 0) {\r\n      jumping = true\r\n    }\r\n    holder.vy += holder.ay\r\n    if (holder.vy > 0 && jumping) {\r\n      holder.vy = 0\r\n    }\r\n    holder.x += holder.vx\r\n    holder.y += holder.vy\r\n    this.collideMapDetection() // 检测是否碰撞地图\r\n  },\r\n  collideMapDetection () {\r\n    if (!this.box) return\r\n    let tileWidth = _levelManager_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].map.tileWidth,\r\n        tileHeight = _levelManager_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"].map.tileHeight,\r\n        tileDataBase = _obstacle_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"].tileDatabase,\r\n        box = this.box,\r\n        holder = this.holder,\r\n        mapTileXLeft, mapTileXRight, mapTileYTop, mapTileYBot\r\n        \r\n    mapTileXLeft = Math.floor(box.left / tileWidth)\r\n    mapTileXRight = Math.floor(box.right / tileWidth)\r\n    mapTileYTop = Math.floor(box.top / tileHeight)\r\n    mapTileYBot = Math.floor(box.bottom / tileHeight)\r\n\r\n    if (holder.vx > 0) { // 角色有向右速度\r\n      for (let tileY in tileDataBase) {\r\n        for (let tileX in tileDataBase[tileY]) {\r\n          if (Number(tileX) === mapTileXRight) {\r\n            let obj = tileDataBase[tileY][tileX].physicsBox\r\n            if (intersect(box, obj)) {\r\n              holder.x = obj.left - (box.right - box.left + 1) // 角色坐标修正\r\n              holder.vx = 0 // 角色速度归零\r\n            }\r\n          }\r\n        }\r\n      }\r\n    } else if (holder.vx < 0) { // 角色有向左速度\r\n      for (let tileY in tileDataBase) {\r\n        for (let tileX in tileDataBase[tileY]) {\r\n          if (Number(tileX) === mapTileXRight) {\r\n            let obj = tileDataBase[tileY][tileX].physicsBox\r\n            if (intersect(box, obj)) {\r\n              holder.x = obj.right + 1\r\n              holder.vx = 0\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (holder.vy > 0) { // 角色有向下速度\r\n      if (tileDataBase[mapTileYTop]) {\r\n        for (let tileX in tileDataBase[mapTileYTop]) {\r\n          let obj = tileDataBase[mapTileYTop][tileX].physicsBox\r\n          if (intersect(box, obj)) {\r\n            holder.y = obj.top - (box.bottom - box.top + 1)\r\n            holder.vy = 0\r\n          }\r\n        }\r\n      }\r\n    } else if (holder.vy < 0) {// 角色有向上速度\r\n      if (tileDataBase[mapTileYTop]) {\r\n        for (let tileX in tileDataBase[mapTileYBot]) {\r\n          let obj = tileDataBase[mapTileYBot][tileX].physicsBox\r\n          if (intersect(box, obj)) {\r\n            holder.y = obj.bottom - 1\r\n            holder.vy = 0\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  collideRoleDetection () {\r\n\r\n  },\r\n  setBox () {\r\n    // 由 whole 产生 box\r\n    let wholeArea = this.wholeArea,\r\n        holder = this.holder,\r\n        w, h\r\n    if (!wholeArea) {\r\n      this.box = null\r\n    } else {\r\n      w = wholeArea.right - wholeArea.left + 1\r\n      h = wholeArea.bottom - wholeArea.top + 1\r\n      this.box = {\r\n        left: holder.x,\r\n        top: holder.y,\r\n        right: holder.x + w - 1,\r\n        bottom: holder.y + h - 1\r\n      }\r\n    }\r\n  },\r\n  setArea (type) { // value of param 'type' is 'attack'\\'body'\\'whole'\r\n    let holder = this.holder,\r\n        boxes = this.boxes[holder._state][type] // 角色还未初始化，_state 仍为字符串\r\n    if (boxes && boxes.length) { // boxes 必定是数组，若非空则长度必和对应状态的帧数相同\r\n      this[type + 'Area'] = boxes[holder.frameIdx]\r\n    } else {\r\n      this[type + 'Area'] = null\r\n    }\r\n  }\r\n}\r\n\r\nfunction intersect(a, b, type) {\r\n  let moreThanArea = b.moreThanArea || 0\r\n  if (!(a.top < b.bottom || a.right < b.left || a.bottom > b.top || a.left > b.right)) {\r\n    if (!moreThanArea) {\r\n      return true\r\n    } else {\r\n      let width, height\r\n      width = a.left < b.left ? a.right - a.left + 1 : b.right - b.left + 1\r\n      height = a.top < b.top ? a.bottom - a.top + 1 : b.bottom - b.top + 1\r\n      if ((width - Math.abs(a.left - b.left)) * (height - Math.abs(a.top - b.top)) > moreThanArea) {\r\n        return true\r\n      }\r\n    }\r\n  }\r\n  return false\r\n}\n\n//# sourceURL=webpack:///./scripts/physics.js?");

/***/ }),

/***/ "./scripts/role.js":
/*!*************************!*\
  !*** ./scripts/role.js ***!
  \*************************/
/*! exports provided: default, State, doorStates */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Role; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"State\", function() { return State; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"doorStates\", function() { return doorStates; });\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ \"./scripts/utils.js\");\n/* harmony import */ var _control_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./control.js */ \"./scripts/control.js\");\n/* harmony import */ var _sequencing_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./sequencing.js */ \"./scripts/sequencing.js\");\n/* harmony import */ var _physics_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./physics.js */ \"./scripts/physics.js\");\n/* harmony import */ var _loader_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./loader.js */ \"./scripts/loader.js\");\n/* harmony import */ var _game_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./game.js */ \"./scripts/game.js\");\n/**\r\n * 定义各种角色状态机，实例化玩家可操作角色并导出\r\n * 对于非玩家可操作角色只导出状态机，在初始化关卡时使用\r\n */\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction Role ({\r\n  assetName,\r\n  states,\r\n  state,\r\n  dir,\r\n  pb, /* boolean */\r\n  health,\r\n  energy,\r\n  vx_max,\r\n  self_ax,\r\n  self_vy\r\n}) {\r\n  if (!assetName || !state) {\r\n    throw new Error(\"Role initialization failed: assetName and state properties are required\")\r\n  }\r\n\r\n  // 内部状态\r\n  this._frameIdx = 0\r\n  this._assetName = assetName\r\n  switch (assetName) {\r\n    case 'King Human':\r\n      this._states = kingHumanStates\r\n      break\r\n    case 'King Pig':\r\n      this._states = kingPigStates\r\n      break\r\n    case 'door':\r\n      this._states = doorStates\r\n      break\r\n  } // 暂时三种\r\n  this._state = state\r\n  this._dir = dir\r\n  this._tick = 0\r\n\r\n  /**\r\n   * 游戏属性\r\n   * more properties: uid, x and y are defined by levelManager\r\n   */\r\n  health ? this.health = health : ''\r\n  energy ? this.energy = energy : ''\r\n  vx_max ? this.vx_max = vx_max : '' // 最大水平移动速度\r\n  self_ax ? this.self_ax = self_ax : '' // 自身能提供的水平加速度\r\n  self_vy ? this.self_vy = self_vy : '' // 起跳时的初始垂直速度\r\n  this.ax = 0\r\n  this.ay = _physics_js__WEBPACK_IMPORTED_MODULE_3__[\"gravity\"]\r\n  this.vx = 0\r\n  this.vy = 0\r\n\r\n  if (pb) {\r\n    this.physicsBox = new _physics_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"](this, this._assetName)\r\n  }\r\n\r\n  this.init()\r\n}\r\n\r\nRole.prototype = {\r\n  constructor: Role,\r\n  handleInput (command) {\r\n    this._state.handleInput(this, command)\r\n  },\r\n  update () {\r\n    this._state.update(this)\r\n    if (this.physicsBox) {\r\n      this.physicsBox.run()\r\n    }\r\n  },\r\n  animate () {\r\n    if (++this._tick > _sequencing_js__WEBPACK_IMPORTED_MODULE_2__[\"FRAME_SWITCH_PERIOD\"]) {\r\n      this._frameIdx++\r\n      this._tick = 1\r\n    }\r\n  },\r\n  setGraphics (graph) {\r\n    this._frameIdx = 0\r\n    this.sprite = _loader_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"].assets.sprite[this._assetName][graph]['sprite']\r\n  },\r\n  render (interpolationFactor) {\r\n    let wholeArea = this.physicsBox.wholeArea,\r\n        w = wholeArea.right - wholeArea.left + 1,\r\n        h = wholeArea.down - wholeArea.up + 1,\r\n        mapX = this.x,\r\n        mapY = this.y\r\n    _game_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"].stage.ctx.save()\r\n    if (this._dir === 'left') {\r\n      _game_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"].stage.ctx.scale(-1, 1)\r\n    }\r\n    _game_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"].stage.ctx.drawImage(this.sprite, wholeArea.x, wholeArea.y, w, h, mapX, mapY, w, h)\r\n    _game_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"].stage.ctx.restore()\r\n  },\r\n  init () {\r\n    this._state = this._states[this._state]\r\n    this._state.enter(this)\r\n  },\r\n  intersectWith () {\r\n    this.physicsBox.intersectWith()\r\n  },\r\n  bleed (health) {\r\n    this.health -= health\r\n  }\r\n}\r\n\r\nfunction State ({name, enter, handleInput, update}) {\r\n  this.name = name\r\n  this.enter = enter\r\n  this.handleInput = handleInput\r\n  this.update = update\r\n}\r\n\r\nState.prototype = {\r\n  enter: _utils_js__WEBPACK_IMPORTED_MODULE_0__[\"abstractMethod\"],\r\n  handleInput: _utils_js__WEBPACK_IMPORTED_MODULE_0__[\"abstractMethod\"],\r\n  update: _utils_js__WEBPACK_IMPORTED_MODULE_0__[\"abstractMethod\"]\r\n}\r\n\r\n// states\r\n\r\nlet kingHumanStates = {\r\n  // perk\r\n  DoorIn: new State({\r\n    name: 'DoorIn',\r\n    enter (ctx) {\r\n      ctx.setGraphics('Door In')\r\n    },\r\n    handleInput: _utils_js__WEBPACK_IMPORTED_MODULE_0__[\"noob\"],\r\n    update (ctx) {\r\n      ctx.animate()\r\n      if (this._frameIdx >= this.sprite.frame) {\r\n        // 结束关卡\r\n      }\r\n    }\r\n  }),\r\n  DoorOut: new State({\r\n    name: 'DoorOut',\r\n    enter (ctx) {\r\n      ctx.setGraphics('Door Out')\r\n    },\r\n    handleInput: _utils_js__WEBPACK_IMPORTED_MODULE_0__[\"noob\"],\r\n    update (ctx) {\r\n      ctx.animate()\r\n      if (this._frameIdx >= this.sprite.frame) {\r\n        ctx.state = kingStates.idle\r\n        ctx.state.enter(ctx)\r\n      }\r\n    }\r\n  }),\r\n  Idle: new State({\r\n    name: 'Idle',\r\n    enter (ctx) {\r\n      ctx.setGraphics('Idle')\r\n    },\r\n    handleInput (ctx, command) {\r\n      if (command === _control_js__WEBPACK_IMPORTED_MODULE_1__[\"InputHandler\"]._attack_) {\r\n        ctx.state = kingStates.attack\r\n        ctx.state.enter(ctx)\r\n      } else if (command === _control_js__WEBPACK_IMPORTED_MODULE_1__[\"InputHandler\"]._keydown_buttonUp_) {\r\n        ctx.state = kingStates.jump\r\n        ctx.state.enter(ctx)\r\n      } else if (command === _control_js__WEBPACK_IMPORTED_MODULE_1__[\"InputHandler\"]._keydown_buttonRight_) {\r\n        ctx.state = kingStates.run\r\n        ctx.state.enter(ctx, command.dir)\r\n      } else if (command === _control_js__WEBPACK_IMPORTED_MODULE_1__[\"InputHandler\"]._keydown_buttonDown_) {\r\n        ctx.state = kingStates.jump\r\n        ctx.state.enter(ctx)\r\n      } else if (command === _control_js__WEBPACK_IMPORTED_MODULE_1__[\"InputHandler\"]._keydown_buttonLeft_) {\r\n        ctx.state = kingStates.run\r\n        ctx.state.enter(ctx, command.dir)\r\n      }\r\n    },\r\n    update (ctx) {\r\n      ctx.animate()\r\n      if (ctx._frameIdx >= ctx.sprite.frame) {\r\n        ctx._frameIdx = 0\r\n      }\r\n      ctx.ax = 0\r\n      ctx.ay = _physics_js__WEBPACK_IMPORTED_MODULE_3__[\"gravity\"]\r\n      ctx.vx = 0\r\n    }\r\n  }),\r\n  Hit: new State({\r\n    name: 'Hit',\r\n    enter (ctx) {\r\n      ctx.setGraphics('Hit')\r\n    },\r\n    handleInput: _utils_js__WEBPACK_IMPORTED_MODULE_0__[\"noob\"],\r\n    update (ctx) {\r\n      ctx.animate()\r\n      if (ctx._frameIdx >= ctx.sprite.frame) {\r\n        if (ctx.health <= 0) {\r\n          ctx.state = kingStates.dead\r\n          ctx.state.enter(ctx)\r\n        } else {\r\n          ctx.state = kingStates.idle\r\n          ctx.state.enter(ctx)\r\n        }\r\n      }\r\n      ctx.ax = 0\r\n      ctx.ay = 0\r\n      ctx.vx = 0\r\n      ctx.vy = 0\r\n    }\r\n  }),\r\n  Dead: new State({\r\n    name: 'Dead',\r\n    enter (ctx) {\r\n      ctx.setGraphics('Dead')\r\n    },\r\n    handleInput: _utils_js__WEBPACK_IMPORTED_MODULE_0__[\"noob\"],\r\n    update (ctx) {\r\n      ctx.animate()\r\n      if (ctx._frameIdx >= ctx.sprite.frame) {\r\n        // game over\r\n      }\r\n      ctx.ax = 0\r\n      ctx.ay = _physics_js__WEBPACK_IMPORTED_MODULE_3__[\"gravity\"]\r\n      ctx.vx = 0\r\n    }\r\n  }),\r\n  // active\r\n  Run: new State({\r\n    name: 'Run',\r\n    enter (ctx, dir) {\r\n      if (dir !== ctx._dir) {\r\n        ctx._dir = dir\r\n        ctx.vx = 0\r\n      }\r\n      ctx.setGraphics('Run')\r\n    },\r\n    handleInput (ctx, command) {\r\n      if (command === _control_js__WEBPACK_IMPORTED_MODULE_1__[\"InputHandler\"]._attack_) {\r\n        ctx.state = kingStates.attack\r\n        ctx.state.enter(ctx)\r\n      } else if (command === _control_js__WEBPACK_IMPORTED_MODULE_1__[\"InputHandler\"]._dorge_) {\r\n        ctx.state = kingStates.dorge\r\n        ctx.state.enter(ctx)\r\n      } else if (command === _control_js__WEBPACK_IMPORTED_MODULE_1__[\"InputHandler\"]._keydown_buttonUp_) {\r\n        ctx.state = kingStates.jump\r\n        ctx.state.enter(ctx)\r\n      }\r\n    },\r\n    update (ctx) {\r\n      ctx.animate()\r\n      if (ctx._frameIdx >= ctx.sprite.frame) {\r\n        ctx._frameIdx = 0\r\n      }\r\n      if (ctx.dir === 'left') {\r\n        ctx.ax = -ctx.self_ax\r\n      } else if (ctx.dir === 'right') {\r\n        ctx.ax = ctx.self_ax\r\n      }\r\n      ctx.ay = _physics_js__WEBPACK_IMPORTED_MODULE_3__[\"gravity\"]\r\n    }\r\n  }),\r\n  Jump: new State({\r\n    name: 'Jump',\r\n    enter (ctx) {\r\n      ctx.setGraphics('Jump')\r\n    },\r\n    handleInput: _utils_js__WEBPACK_IMPORTED_MODULE_0__[\"noob\"],\r\n    update (ctx) {\r\n      if (ctx._frameIdx >= ctx.sprite.frame) {\r\n        ctx._frameIdx = 0\r\n      }\r\n      if (ctx.vy = 0) {\r\n        ctx.state = kingStates.fall\r\n        ctx.state.enter(ctx)\r\n      }\r\n      ctx.ay = _physics_js__WEBPACK_IMPORTED_MODULE_3__[\"gravity\"]\r\n      ctx.vy = -self_vy\r\n    }\r\n  }),\r\n  Fall: new State({\r\n    name: 'Fall',\r\n    enter (ctx) {\r\n      ctx.setGraphics('Fall')\r\n    },\r\n    handleInput: _utils_js__WEBPACK_IMPORTED_MODULE_0__[\"noob\"],\r\n    update () {\r\n      if (ctx._frameIdx >= ctx.sprite.frame) {\r\n        ctx._frameIdx = 0\r\n      }\r\n      if (ctx.vy = 0) {\r\n        ctx.state = kingStates.ground\r\n        ctx.state.enter(ctx)\r\n      }\r\n    }\r\n  }),\r\n  Ground: new State({\r\n    name: 'Ground',\r\n    enter (ctx) {\r\n      ctx.setGraphics('Ground')\r\n    },\r\n    handleInput: _utils_js__WEBPACK_IMPORTED_MODULE_0__[\"noob\"],\r\n    update () {\r\n      if (ctx._frameIdx >= ctx.sprite.frame) {\r\n        ctx.state = kingStates.idle\r\n        ctx.state.enter(ctx)\r\n      }\r\n    }\r\n  }),\r\n  Attack: new State({\r\n    name: 'Attack',\r\n    enter (ctx) {\r\n      ctx.setGraphics('Attack')\r\n    },\r\n    handleInput: _utils_js__WEBPACK_IMPORTED_MODULE_0__[\"noob\"],\r\n    update () {\r\n      // 判断碰撞\r\n\r\n      if (ctx._frameIdx >= ctx.sprite.frame) {\r\n        ctx.state = kingStates.idle\r\n        ctx.state.enter(ctx)\r\n      }\r\n    }\r\n  }),\r\n  // 暂时忽略此状态\r\n  Dorge: new State({\r\n    name: 'Dorge',\r\n    enter (ctx) {\r\n      ctx.setGraphics()\r\n    },\r\n    handleInput: _utils_js__WEBPACK_IMPORTED_MODULE_0__[\"noob\"],\r\n    update () {\r\n  \r\n    }\r\n  })\r\n}\r\n\r\nlet doorStates = {\r\n  idle: new State({\r\n    name: 'idle',\r\n    enter (ctx) {\r\n      ctx.setGraphics('Idle')\r\n    },\r\n    handleInput: _utils_js__WEBPACK_IMPORTED_MODULE_0__[\"noob\"],\r\n    update () {\r\n      \r\n    }\r\n  }),\r\n  opening: new State({\r\n    name: 'opening',\r\n    enter (ctx) {\r\n      ctx.setGraphics('Opening')\r\n    },\r\n    handleInput: _utils_js__WEBPACK_IMPORTED_MODULE_0__[\"noob\"],\r\n    update () {\r\n      \r\n    }\r\n  }),\r\n  closing: new State({\r\n    name: 'closing',\r\n    enter (ctx) {\r\n      ctx.setGraphics('Closing')\r\n    },\r\n    handleInput: _utils_js__WEBPACK_IMPORTED_MODULE_0__[\"noob\"],\r\n    update () {\r\n      \r\n    }\r\n  })\r\n}\r\n\r\nlet kingPigStates = {\r\n\r\n}\n\n//# sourceURL=webpack:///./scripts/role.js?");

/***/ }),

/***/ "./scripts/sequencing.js":
/*!*******************************!*\
  !*** ./scripts/sequencing.js ***!
  \*******************************/
/*! exports provided: FRAME_SWITCH_PERIOD, roleArray, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FRAME_SWITCH_PERIOD\", function() { return FRAME_SWITCH_PERIOD; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"roleArray\", function() { return roleArray; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return gameLoop; });\n/* harmony import */ var _game_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./game.js */ \"./scripts/game.js\");\n\r\n\r\nconst MS_PER_UPDATE = 33, // 30 game frame per seconds: updating game state and handling input\r\n  MS_PER_FRAME = 100, // 10 animation frame per seconds: switching animation frame\r\n  previous = 0,\r\n  update_lag = 0\r\n\r\nconst FRAME_SWITCH_PERIOD = Math.floor(MS_PER_FRAME / MS_PER_UPDATE)\r\n\r\nlet roleArray = []\r\n\r\nfunction gameLoop (timeStamp) {\r\n  let elapsed = timeStamp - previous\r\n  previous = timeStamp\r\n  update_lag += elapsed\r\n  while (update_lag > MS_PER_UPDATE) {\r\n    update()\r\n    update_lag -= MS_PER_UPDATE\r\n  }\r\n  render(update_lag/MS_PER_UPDATE)\r\n  requestAnimationFrame(gameLoop) // update screen in generally 60 FPS: smoothing the shift\r\n}\r\n\r\nfunction update () {\r\n  roleArray.forEach(role => role.update())\r\n}\r\n\r\nfunction render (interpolationFactor) {\r\n  let stage = _game_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].stage\r\n  stage.ctx.clearRect(0, 0, stage.width, stage.height)\r\n  roleArray.forEach(role => role.render())\r\n}\r\n\n\n//# sourceURL=webpack:///./scripts/sequencing.js?");

/***/ }),

/***/ "./scripts/stage.js":
/*!**************************!*\
  !*** ./scripts/stage.js ***!
  \**************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Stage; });\nfunction Stage ({\r\n  id,\r\n  backgroundId,\r\n  inputHandler,\r\n  anti_aliasing\r\n}) {\r\n  if (!(id && backgroundId)) throw new Error('Id & backgroundId are required')\r\n\r\n  var canvas = this.canvas = document.getElementById(id),\r\n      backCanvas = document.getElementById(backgroundId)\r\n\r\n  if (inputHandler) {\r\n    this.installInputHandler(inputHandler, canvas)\r\n  }\r\n\r\n  this.width = canvas.width\r\n  this.height = canvas.height\r\n\r\n  this.bCtx = backCanvas.getContext('2d')\r\n  this.ctx = canvas.getContext('2d')\r\n\r\n  this.bCtx.imageSmoothingEnabled = anti_aliasing || true\r\n  this.ctx.imageSmoothingEnabled = anti_aliasing || true // true as default\r\n}\r\n\r\nStage.prototype = {\r\n  constructor: Stage,\r\n  installInputHandler (inputHandler, canvas) {\r\n    // keyboardEvent binding\r\n    if (inputHandler.onKeyDown) canvas.addEventListener('keydown', inputHandler.onKeyDown)\r\n    if (inputHandler.onKeyUp) canvas.addEventListener('keyup', inputHandler.onKeyUp)\r\n    if (inputHandler.onKeyPress) canvas.addEventListener('keypress', inputHandler.onKeyPress)\r\n\r\n    // mouseEvent binding\r\n    if (inputHandler.onMousemove) canvas.addEventListener('mousemove', inputHandler.onMousemove)\r\n    if (inputHandler.onMouseenter) canvas.addEventListener('mouseenter', inputHandler.onMouseEnter)\r\n    if (inputHandler.onMouseLeave) canvas.addEventListener('mouseleave', inputHandler.onMouseLeave)\r\n    if (inputHandler.onMouseDown) canvas.addEventListener('mousedown', inputHandler.onMouseDown)\r\n    if (inputHandler.onMouseUp) canvas.addEventListener('mouseup', inputHandler.onMouseUp)\r\n    if (inputHandler.onContextMenu) canvas.addEventListener('contextmenu', inputHandler.onContextMenu)\r\n  }\r\n}\n\n//# sourceURL=webpack:///./scripts/stage.js?");

/***/ }),

/***/ "./scripts/utils.js":
/*!**************************!*\
  !*** ./scripts/utils.js ***!
  \**************************/
/*! exports provided: noob, abstractMethod, AbstractConstructor, throttle, debounce, addEvent, removeEvent, convertFileName, toType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"noob\", function() { return noob; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"abstractMethod\", function() { return abstractMethod; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AbstractConstructor\", function() { return AbstractConstructor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"throttle\", function() { return throttle; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"debounce\", function() { return debounce; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"addEvent\", function() { return addEvent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"removeEvent\", function() { return removeEvent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"convertFileName\", function() { return convertFileName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"toType\", function() { return toType; });\n// empty function\r\n\r\nfunction noob () {}\r\n\r\n// abstract method & constructor\r\n\r\nfunction abstractMethod () {\r\n  throw new Error('Abstract method')\r\n}\r\n\r\nfunction AbstractConstructor () {\r\n  throw new Error(\"Can't instantiate abstract classes\")\r\n}\r\n\r\n// utilities\r\nfunction extend (o, p) {\r\n  for (let prop in p) o[prop] = p[prop]\r\n  return o\r\n}\r\n\r\nfunction defineSubClass (superclass,\r\n                         constructor,\r\n                         methods,\r\n                         statics) {\r\n  constructor.prototype = Object.create(superclass.prototype)\r\n  constructor.prototype.constructor = constructor\r\n  if (methods) extend(constructor.prototype, methods)\r\n  if (statics) extend(constructor, statics)\r\n  return constructor\r\n}\r\n\r\nFunction.prototype.extend = function (constructor, methods, statics) {\r\n  return defineSubClass(this, constructor, methods, statics)\r\n}\r\n\r\n/*\r\n * desc 函数节流\r\n * param fn 函数\r\n * param wait 延迟执行毫秒数\r\n * param type 1 表时间戳版，2 表定时器版\r\n */\r\n\r\nfunction throttle (fn, wait, type) {\r\n  let lastTime = 0,\r\n      t = null\r\n  return function () {\r\n    if (type === 1) {\r\n      let now = Date.now()\r\n      if (now - lastTime > wait) {\r\n        fn.apply(this, arguments)\r\n        lastTime = now\r\n      } \r\n    } else if (type === 2) {\r\n      if (t) return\r\n      t = setTimeout(() => {\r\n        fn.apply(this, arguments)\r\n        t = null\r\n      }, wait)\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * desc 函数防抖\r\n * param fn 函数\r\n * param wait 延迟执行毫秒数\r\n * param immediate true 表立即执行，false 表非立即执行\r\n */\r\n\r\nfunction debounce (fn, wait, immediate) {\r\n  let t = null\r\n  return function () {\r\n    if (t) clearTimeout(t)\r\n    if (immediate) {\r\n      if (!t) {\r\n        fn.apply(this, arguments)\r\n      }\r\n      t = setTimeout(() => t = null, wait)\r\n    } else {\r\n      t = setTimeout(() => {\r\n        fn.apply(this, arguments)\r\n        t = null\r\n      }, wait)\r\n    }\r\n  }\r\n}\r\n\r\nconst {addEvent, removeEvent} = (function () {\r\n  if (window.addEventListener) {\r\n    return {\r\n      addEvent: function (el, type, fn) {\r\n        el.addEventListener(type, fn, false)\r\n      },\r\n      removeEvent: function (el, type, fn) {\r\n        el.removeEventListener(type, fn, false)\r\n      }\r\n    }\r\n  } else if (document.attachEvent) {\r\n    return {\r\n      addEvent: function (el, type, fn) {\r\n        el.attachEvent('on' + type, fn)\r\n      },\r\n      removeEvent: function (el, type, fn) {\r\n        el.detachEvent('on' + type, fn)\r\n      }\r\n    }\r\n  } else {\r\n    return {\r\n      addEvent: function (el, type, fn) {\r\n        el['on'+type] = fn\r\n      },\r\n      removeEvent: function (el, type, fn) {\r\n        el['on'+type] = null\r\n      }\r\n    }\r\n  }\r\n})()\r\n\r\nfunction convertFileName(fileName) {\r\n  // return fileName.replace(/\\s\\(\\)\\.(png|tsx)/, '')\r\n  return fileName.replace(/(\\s\\(.*\\))?\\.(png|tsx)/, '')\r\n}\r\n\r\nfunction toType(val) {\r\n  return Object.prototype.toString.call(val).slice(8, -1)\r\n}\r\n// module.exports = {\r\n//   convertFileName\r\n// }\n\n//# sourceURL=webpack:///./scripts/utils.js?");

/***/ })

/******/ });